{"ast":null,"code":"var _jsxFileName = \"/Users/nathanmajumder/crossword-react-app/crossword-app/src/components/CrosswordBoardApp.jsx\";\nimport React, { Fragment, Component } from 'react';\nimport PropTypes from 'prop-types';\nimport '../css/CrosswordBoardApp.css';\nimport SquareSelection from '../libs/SquareSelection.js';\nimport CrosswordClueScroll from './CrosswordClueScroll.jsx';\nimport CrosswordKeyActions from '../libs/CrosswordKeyActions.js';\n\nclass CrosswordBoardApp extends Component {\n  constructor(props) {\n    super(props);\n    this.numbered = this.props.crossword.numbered;\n    this.acrossClues = this.props.crossword.acrossClues.sort((c1, c2) => c1.number > c2.number ? 1 : -1);\n    this.downClues = this.props.crossword.downClues.sort((c1, c2) => c1.number > c2.number ? 1 : -1);\n    this.clueRefMap = this.props.crossword.clueRefMap;\n    let currentSelection = new SquareSelection();\n    let i = 0;\n\n    while (this.props.crossword.numbered[0][i] === \"_\") {\n      i++;\n    }\n\n    currentSelection.coords = [0, i];\n    currentSelection.direction = \"Across\";\n    this.state = {\n      currentSelection: currentSelection,\n      grid: this.props.crossword.grid\n    };\n    this.acrossClueClicked = this.acrossClueClicked.bind(this);\n    this.downClueClicked = this.downClueClicked.bind(this);\n    this.boardSquareClicked = this.boardSquareClicked.bind(this);\n    this.getSelectedSquares = this.getSelectedSquares.bind(this);\n    this.getReferencedSquares = this.getReferencedSquares.bind(this);\n    this.getSquareBackgroundColor = this.getSquareBackgroundColor.bind(this);\n    this.onKeyDown = this.onKeyDown.bind(this);\n  }\n\n  componentDidMount() {\n    console.log(\"Crossword Board App is Mounting...\");\n    document.addEventListener(\"keydown\", this.onKeyDown, false);\n  }\n\n  componentWillUnmount() {\n    console.log(\"Crossword Board App is Unmounting...\");\n    document.removeEventListener(\"keydown\", this.onKeyDown, false); // save state of grid\n  }\n\n  onKeyDown(event) {\n    console.log(event); // if special key pressed, allow default action\n\n    if (event.ctrlKey || event.altKey || event.metaKey) {\n      return;\n    }\n\n    event.preventDefault();\n\n    if (this.props.typingDisabled) {\n      return;\n    }\n\n    let selection = this.state.currentSelection;\n\n    if (event.which === 13 || event.which === 9) {\n      // enter or tab\n      selection = CrosswordKeyActions.tabOrEnter(this.state.grid, selection, event.shiftKey, this.acrossClues, this.downClues);\n    } else if (event.which === 8) {// delete\n    } else if (event.which === 37) {\n      // left arrow\n      selection = CrosswordKeyActions.leftArrow(this.state.grid, selection);\n    } else if (event.which === 38) {\n      // up arrow\n      selection = CrosswordKeyActions.upArrow(this.state.grid, selection);\n    } else if (event.which === 39) {\n      // right arrow\n      selection = CrosswordKeyActions.rightArrow(this.state.grid, selection);\n    } else if (event.which === 40) {\n      // down arrow\n      selection = CrosswordKeyActions.downArrow(this.state.grid, selection);\n    } else if (event.which >= 65 && event.which <= 90) {\n      // a to z\n      selection = CrosswordKeyActions.alphaNumeric(this.state.grid, selection, event.key.toUpperCase());\n    } else if (event.which >= 48 && event.which <= 57) {\n      // 0 to 9\n      if (event.shiftKey) return;\n      selection = CrosswordKeyActions.alphaNumeric(this.state.grid, selection, event.key);\n    }\n\n    this.setState({\n      currentSelection: selection\n    });\n  }\n\n  acrossClueClicked(clue) {\n    console.log('Clicked down clue with number: ' + clue.number);\n  }\n\n  downClueClicked(clue) {\n    console.log('Clicked down clue with number: ' + clue.number);\n  }\n\n  boardSquareClicked(square) {\n    if (square.value === \"_\") {\n      return;\n    }\n\n    let selection = this.state.currentSelection;\n\n    if (square.rowCoord === selection.coords[0] && square.colCoord === selection.coords[1]) {\n      selection.flipDirection();\n    } else {\n      selection.coords = [square.rowCoord, square.colCoord];\n    }\n\n    this.setState({\n      currentSelection: selection\n    });\n  }\n\n  getSelectedSquares(selection) {\n    const coords = selection.coords;\n    const direction = selection.direction;\n    let boardSquare = this.state.grid[coords[0]][coords[1]];\n    let selectedCoordList = [];\n\n    if (direction === \"Across\") {\n      let clue = this.acrossClues.find(clue => clue.number === boardSquare.acrossClueNum);\n      let firstCoords = [clue.rowCoord, clue.colCoord];\n      let wordLen = clue.answerLength;\n\n      for (let i = firstCoords[1]; i < firstCoords[1] + wordLen; i++) {\n        selectedCoordList.push([firstCoords[0], i].toString());\n      }\n    } else {\n      let clue = this.downClues.find(clue => clue.number === boardSquare.downClueNum);\n      let firstCoords = [clue.rowCoord, clue.colCoord];\n      let wordLen = clue.answerLength;\n\n      for (let i = firstCoords[0]; i < firstCoords[0] + wordLen; i++) {\n        selectedCoordList.push([i, firstCoords[1]].toString());\n      }\n    }\n\n    return selectedCoordList;\n  }\n\n  getReferencedSquares(selection) {\n    const coords = selection.coords;\n    const direction = selection.direction;\n    let selectedCoordList = [];\n\n    if (direction === \"Across\") {\n      let clueNum = this.state.grid[coords[0]][coords[1]].acrossClueNum;\n      let clueKey = \"A\" + clueNum;\n\n      if (this.clueRefMap.has(clueKey)) {\n        for (let key of this.clueRefMap.get(clueKey)) {}\n      }\n    }\n  }\n\n  getSquaresOfClue(clue) {\n    const [firstRow, firstCol] = [clue.rowCoord, clue.colCoord];\n    let coordList = [];\n\n    if (clue.direction === \"ACROSS\") {\n      for (let i = firstCol; i < clue.answerLength; i++) {\n        coordList.push([firstRow, i]);\n      }\n    } else {\n      for (let i = firstRow; i < clue.answerLength; i++) {\n        coordList.push([i, firstCol]);\n      }\n    }\n\n    return coordList;\n  }\n\n  getSquareBackgroundColor(square, selection, highlightedSquares) {\n    if (square.value === \"_\") return \"black\";\n    let thisSquareKey = [square.rowCoord, square.colCoord].toString();\n\n    if (highlightedSquares.includes(thisSquareKey)) {\n      if (thisSquareKey === selection.coords.toString()) {\n        return this.props.settings.colorScheme.colors[1];\n      } else {\n        return this.props.settings.colorScheme.colors[2];\n      }\n    }\n\n    return \"white\";\n  }\n\n  render() {\n    const {\n      currentSelection,\n      grid\n    } = this.state;\n    let clueWidthPx = \"\" + (this.props.windowWidthPx - (this.props.boardWidthPx + 160) - 2) + \"px\";\n    const boardPx = this.props.boardWidthPx;\n    const boardSize = this.props.crossword.grid.length;\n    const rowPx = boardPx / boardSize;\n    const squarePx = rowPx - 1;\n    const highlightedSquares = this.getSelectedSquares(currentSelection);\n    const referencedSquares = this.getReferencedSquares(currentSelection);\n    const acrossClue = this.acrossClues.find(c => c.number === grid[currentSelection.coords[0]][currentSelection.coords[1]].acrossClueNum);\n    const downClue = this.downClues.find(c => c.number === grid[currentSelection.coords[0]][currentSelection.coords[1]].downClueNum);\n    return /*#__PURE__*/React.createElement(Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"crossword-board-and-clues-wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"crossword-board\",\n      style: {\n        width: boardPx,\n        height: boardPx\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 21\n      }\n    }, grid.map((row, i) => /*#__PURE__*/React.createElement(\"div\", {\n      key: i,\n      style: {\n        height: rowPx\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 29\n      }\n    }, row.map((square, j) => /*#__PURE__*/React.createElement(\"div\", {\n      key: j,\n      className: \"crossword-square\",\n      onClick: () => {\n        this.boardSquareClicked(square);\n      },\n      style: {\n        width: squarePx,\n        height: squarePx,\n        backgroundColor: this.getSquareBackgroundColor(square, currentSelection, highlightedSquares)\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"board-square-number\",\n      style: {\n        fontSize: `${boardSize > 15 ? \"6pt\" : `${boardSize > 10 ? \"9pt\" : \"12pt\"}`}`\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 41\n      }\n    }, this.numbered[i][j] !== \"_\" && this.numbered[i][j] !== \"0\" ? this.numbered[i][j] : \"\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"board-square-value\",\n      style: {\n        width: squarePx,\n        height: squarePx / 2,\n        marginTop: squarePx * 3 / 10,\n        fontSize: `${boardSize > 15 ? \"14pt\" : \"17pt\"}`\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 41\n      }\n    }, square.value === \"?\" || square.value === '_' ? '' : square.value)))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"crossword-clue-section\",\n      style: {\n        width: clueWidthPx,\n        height: boardPx\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(CrosswordClueScroll, {\n      listTitle: \"Across\",\n      clueList: this.acrossClues,\n      selectedClue: acrossClue,\n      isMatchingDirection: currentSelection.direction === 'Across',\n      clueClicked: this.acrossClueClicked,\n      settings: this.props.settings,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(CrosswordClueScroll, {\n      listTitle: \"Down\",\n      clueList: this.downClues,\n      selectedClue: downClue,\n      isMatchingDirection: currentSelection.direction === 'Down',\n      clueClicked: this.downClueClicked,\n      settings: this.props.settings,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 25\n      }\n    }))));\n  }\n\n}\n\nCrosswordBoardApp.propTypes = {\n  crossword: PropTypes.object.isRequired,\n  typingDisabled: PropTypes.bool.isRequired,\n  boardWidthPx: PropTypes.number.isRequired,\n  windowWidthPx: PropTypes.number.isRequired,\n  settings: PropTypes.object.isRequired\n};\nexport default CrosswordBoardApp;","map":{"version":3,"sources":["/Users/nathanmajumder/crossword-react-app/crossword-app/src/components/CrosswordBoardApp.jsx"],"names":["React","Fragment","Component","PropTypes","SquareSelection","CrosswordClueScroll","CrosswordKeyActions","CrosswordBoardApp","constructor","props","numbered","crossword","acrossClues","sort","c1","c2","number","downClues","clueRefMap","currentSelection","i","coords","direction","state","grid","acrossClueClicked","bind","downClueClicked","boardSquareClicked","getSelectedSquares","getReferencedSquares","getSquareBackgroundColor","onKeyDown","componentDidMount","console","log","document","addEventListener","componentWillUnmount","removeEventListener","event","ctrlKey","altKey","metaKey","preventDefault","typingDisabled","selection","which","tabOrEnter","shiftKey","leftArrow","upArrow","rightArrow","downArrow","alphaNumeric","key","toUpperCase","setState","clue","square","value","rowCoord","colCoord","flipDirection","boardSquare","selectedCoordList","find","acrossClueNum","firstCoords","wordLen","answerLength","push","toString","downClueNum","clueNum","clueKey","has","get","getSquaresOfClue","firstRow","firstCol","coordList","highlightedSquares","thisSquareKey","includes","settings","colorScheme","colors","render","clueWidthPx","windowWidthPx","boardWidthPx","boardPx","boardSize","length","rowPx","squarePx","referencedSquares","acrossClue","c","downClue","width","height","map","row","j","backgroundColor","fontSize","marginTop","propTypes","object","isRequired","bool"],"mappings":"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","sourcesContent":["import React, { Fragment, Component } from 'react'\nimport PropTypes from 'prop-types'\nimport '../css/CrosswordBoardApp.css'\nimport SquareSelection from '../libs/SquareSelection.js'\nimport CrosswordClueScroll from './CrosswordClueScroll.jsx'\nimport CrosswordKeyActions from '../libs/CrosswordKeyActions.js'\n\nclass CrosswordBoardApp extends Component {\n    constructor (props) {\n        super(props)\n\n        this.numbered = this.props.crossword.numbered\n        this.acrossClues = this.props.crossword.acrossClues.sort((c1, c2) => (c1.number > c2.number) ? 1 : -1)\n        this.downClues = this.props.crossword.downClues.sort((c1, c2) => (c1.number > c2.number) ? 1 : -1)\n        this.clueRefMap = this.props.crossword.clueRefMap\n        \n        let currentSelection = new SquareSelection()\n        let i = 0\n        while (this.props.crossword.numbered[0][i] === \"_\") {\n            i++\n        }\n        currentSelection.coords = [0,i]\n        currentSelection.direction = \"Across\"\n\n        this.state = {\n            currentSelection: currentSelection,\n            grid: this.props.crossword.grid\n        }\n\n        this.acrossClueClicked = this.acrossClueClicked.bind(this)\n        this.downClueClicked = this.downClueClicked.bind(this)\n        this.boardSquareClicked = this.boardSquareClicked.bind(this)\n\n        this.getSelectedSquares = this.getSelectedSquares.bind(this)\n        this.getReferencedSquares = this.getReferencedSquares.bind(this)\n        this.getSquareBackgroundColor = this.getSquareBackgroundColor.bind(this)\n\n        this.onKeyDown = this.onKeyDown.bind(this)\n    }\n\n    componentDidMount () {\n        console.log(\"Crossword Board App is Mounting...\")\n        document.addEventListener(\"keydown\", this.onKeyDown, false);\n    }\n\n    componentWillUnmount () {\n        console.log(\"Crossword Board App is Unmounting...\")\n        document.removeEventListener(\"keydown\", this.onKeyDown, false);\n        // save state of grid\n    }\n\n    onKeyDown (event) {\n        console.log(event)\n        // if special key pressed, allow default action\n        if (event.ctrlKey || event.altKey || event.metaKey) {\n            return\n        }\n        event.preventDefault()\n        if (this.props.typingDisabled) {\n            return\n        }\n        let selection = this.state.currentSelection\n        if (event.which === 13 || event.which === 9) {\n            // enter or tab\n            selection = CrosswordKeyActions.tabOrEnter(this.state.grid, selection, event.shiftKey, this.acrossClues, this.downClues)\n        } else if (event.which === 8) {\n            // delete\n\n        } else if (event.which === 37) {\n            // left arrow\n            selection = CrosswordKeyActions.leftArrow(this.state.grid, selection)\n        } else if (event.which === 38) {\n            // up arrow\n            selection = CrosswordKeyActions.upArrow(this.state.grid, selection)\n        } else if (event.which === 39) {\n            // right arrow\n            selection = CrosswordKeyActions.rightArrow(this.state.grid, selection)\n        } else if (event.which === 40) {\n            // down arrow\n            selection = CrosswordKeyActions.downArrow(this.state.grid, selection)\n        } else if (event.which >= 65 && event.which <= 90) {\n            // a to z\n            selection = CrosswordKeyActions.alphaNumeric(this.state.grid, selection, event.key.toUpperCase())\n        } else if (event.which >= 48 && event.which <= 57) {\n            // 0 to 9\n            if (event.shiftKey) return\n            selection = CrosswordKeyActions.alphaNumeric(this.state.grid, selection, event.key)\n        }\n        \n        this.setState({\n            currentSelection: selection\n        })\n    }\n\n    acrossClueClicked (clue) {\n        console.log('Clicked down clue with number: ' + clue.number)\n    }\n\n    downClueClicked (clue) {\n        console.log('Clicked down clue with number: ' + clue.number)\n    }\n\n    boardSquareClicked (square) {\n        if (square.value === \"_\") {\n            return\n        }\n        let selection = this.state.currentSelection\n        if (square.rowCoord === selection.coords[0] && square.colCoord === selection.coords[1]) {\n            selection.flipDirection()\n        } else {\n            selection.coords = [square.rowCoord, square.colCoord]\n        }\n        this.setState({\n            currentSelection: selection\n        })\n    }\n\n    getSelectedSquares (selection) {\n        const coords = selection.coords\n        const direction = selection.direction\n        let boardSquare = this.state.grid[coords[0]][coords[1]]\n        let selectedCoordList = []\n        if (direction === \"Across\") {\n            let clue = this.acrossClues.find(clue => clue.number === boardSquare.acrossClueNum)\n            let firstCoords = [clue.rowCoord, clue.colCoord]\n            let wordLen = clue.answerLength\n            for (let i = firstCoords[1]; i < firstCoords[1] + wordLen; i++) {\n                selectedCoordList.push([firstCoords[0],i].toString())\n            }\n        } else {\n            let clue = this.downClues.find(clue => clue.number === boardSquare.downClueNum)\n            let firstCoords = [clue.rowCoord, clue.colCoord]\n            let wordLen = clue.answerLength\n            for (let i = firstCoords[0]; i < firstCoords[0] + wordLen; i++) {\n                selectedCoordList.push([i,firstCoords[1]].toString())\n            }\n        }\n        return selectedCoordList\n    }\n\n    getReferencedSquares (selection) {\n        const coords = selection.coords\n        const direction = selection.direction\n        let selectedCoordList = []\n        if (direction === \"Across\") {\n            let clueNum = this.state.grid[coords[0]][coords[1]].acrossClueNum\n            let clueKey = \"A\" + clueNum\n            if (this.clueRefMap.has(clueKey)) {\n                for (let key of this.clueRefMap.get(clueKey)) {\n\n                }\n            }\n        }\n    }\n\n    getSquaresOfClue (clue) {\n        const [firstRow, firstCol] = [clue.rowCoord, clue.colCoord]\n        let coordList = []\n        if (clue.direction === \"ACROSS\") {\n            for (let i = firstCol; i < clue.answerLength; i++) {\n                coordList.push([firstRow, i])\n            }\n        } else {\n            for (let i = firstRow; i < clue.answerLength; i++) {\n                coordList.push([i, firstCol])\n            }\n        }\n        return coordList\n    }\n\n    getSquareBackgroundColor (square, selection, highlightedSquares) {\n        if (square.value === \"_\") return \"black\"\n        let thisSquareKey = [square.rowCoord, square.colCoord].toString()\n        if (highlightedSquares.includes(thisSquareKey)) {\n            if (thisSquareKey === selection.coords.toString()) {\n                return this.props.settings.colorScheme.colors[1]\n            } else {\n                return this.props.settings.colorScheme.colors[2]\n            }\n        }\n        return \"white\"\n    }\n\n    render () {\n        const { currentSelection, grid } = this.state\n        let clueWidthPx = \"\" + (this.props.windowWidthPx - (this.props.boardWidthPx + 160) - 2) + \"px\"\n\n        const boardPx = this.props.boardWidthPx\n        const boardSize = this.props.crossword.grid.length\n        const rowPx = boardPx / boardSize\n        const squarePx = rowPx - 1\n\n        const highlightedSquares = this.getSelectedSquares(currentSelection)\n        const referencedSquares = this.getReferencedSquares(currentSelection)\n\n        const acrossClue = this.acrossClues.find(c => c.number === grid[currentSelection.coords[0]][currentSelection.coords[1]].acrossClueNum)\n        const downClue = this.downClues.find(c => c.number === grid[currentSelection.coords[0]][currentSelection.coords[1]].downClueNum)\n\n        return (\n            <Fragment>\n                <div className=\"crossword-board-and-clues-wrapper\">\n                    <div className=\"crossword-board\" style={{ width : boardPx, height : boardPx }}>\n                        {grid.map( (row, i) =>\n                            <div key={i} style={{height : rowPx}}>\n                                {row.map( (square, j) => \n                                    <div key={j} className={\"crossword-square\"} onClick={() => { this.boardSquareClicked(square) }}\n                                            style={{width : squarePx, height : squarePx, \n                                                backgroundColor : this.getSquareBackgroundColor(square, currentSelection, highlightedSquares)}}>\n                                        <div className=\"board-square-number\" \n                                            style={{fontSize: `${boardSize > 15 ? \"6pt\" : `${boardSize > 10 ? \"9pt\" : \"12pt\"}`}`}}>\n                                            {this.numbered[i][j] !== \"_\" && this.numbered[i][j] !== \"0\" ? this.numbered[i][j] : \"\"}</div>\n                                        <div className=\"board-square-value\" style={{width : squarePx, height : squarePx/2, \n                                                marginTop: squarePx*3/10, fontSize: `${boardSize > 15 ? \"14pt\" : \"17pt\"}`}}>\n                                            {square.value === \"?\" || square.value === '_' ? '' : square.value}\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n\n                        )}\n                    </div>\n                    <div className=\"crossword-clue-section\" style={{width : clueWidthPx, height : boardPx}}>\n                        <CrosswordClueScroll \n                            listTitle={\"Across\"}\n                            clueList={this.acrossClues}\n                            selectedClue={acrossClue}\n                            isMatchingDirection={currentSelection.direction === 'Across'}\n                            clueClicked={this.acrossClueClicked}\n                            settings={this.props.settings}/>\n                        <CrosswordClueScroll \n                            listTitle={\"Down\"}\n                            clueList={this.downClues}\n                            selectedClue={downClue}\n                            isMatchingDirection={currentSelection.direction === 'Down'}\n                            clueClicked={this.downClueClicked}\n                            settings={this.props.settings}/>\n                    </div>\n                </div>\n            </Fragment>\n        )\n    }\n}\n\nCrosswordBoardApp.propTypes = {\n    crossword: PropTypes.object.isRequired,\n    typingDisabled: PropTypes.bool.isRequired,\n    boardWidthPx: PropTypes.number.isRequired,\n    windowWidthPx: PropTypes.number.isRequired,\n    settings: PropTypes.object.isRequired\n}\n\nexport default CrosswordBoardApp"]},"metadata":{},"sourceType":"module"}